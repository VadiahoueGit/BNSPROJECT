<div class="card">
  <p-table
    [styleClass]="'p-datatable-sm'"
    #dt2
    [value]="dataList"
    dataKey="id"
    [rows]="8"
    [totalRecords]="totalPages" [lazy]="true"
    [rowsPerPageOptions]="[10, 25, 50]"
    [paginator]="true"
    (onPage)="onPage($event)"
  >
    <ng-template pTemplate="header">
      <tr>
        <th style="color: var(--secondary-color)"></th>
        <th style="color: var(--secondary-color)">Nom du compte</th>
        <th style="color: var(--secondary-color)">Soldes</th>
        <th style="color: var(--secondary-color)">Montants perçus</th>
        <th style="color: var(--secondary-color)">Montants à perçevoir</th>
        <th style="color: var(--secondary-color)">Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-dataList>
      <tr>
        <td>
          <div class="d-flex align-items-center justify-content-center bg-simple">
            <i style="font-size: 14px;" class="fad fa-cash-register"></i>
          </div>
        </td>
        <td>
                <span class="ml-1 vertical-align-middle fw-bold">
                  {{ dataList.nomDepot }}
                </span>
        </td>
        <td>
                <span class="ml-1 vertical-align-middle bg-simple fw-bold">
                 {{ +dataList.montantPercuTotal + +dataList.montantAPercevoirTotal | currency:'XOF' }}
                </span>
        </td>
        <td>
                <span class="ml-1 vertical-align-middle bg-entry">
                  {{ dataList.montantPercuTotal | currency:'XOF' }}
                </span>
        </td>
        <td>
                <span class="ml-1 vertical-align-middle bg-out">
                  {{ dataList.montantAPercevoirTotal | currency:'XOF' }}
                </span>
        </td>
        <td class=" text-center">
          <i
            style="cursor: pointer"
            (click)="OnViewDetail(dataList)"
            class="fas fa-eye text-secondary"
          ></i>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="5">Aucun élément trouvé.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<div *ngIf="isModalOpen" class="custom-modal">
  <div class="modal-dialog  modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header d-flex align-items-center">
        <div class="d-flex justify-content-center align-items-center"
             style="background-color: rgb(219, 255, 232); border-radius: 3rem; width: 3rem; height: 3rem;">
          <i class="fas fa-box-check text-primary fs-3"></i>
        </div>
        <h1 class="modal-title fs-5 ms-3" id="staticBackdropLabel">Historique de transactions</h1>
      </div>
      <div class="modal-body" style="max-height: 500px;overflow-y: auto">
        <p-table
          [styleClass]="'p-datatable-sm'"
          #dt2
          [value]="updateData"
          dataKey="id"

        >
          <ng-template pTemplate="header">
            <tr>
              <th style="color: var(--secondary-color)"></th>
              <th style="color: var(--secondary-color)">Paiement de</th>
              <th style="color: var(--secondary-color)">Type opérations</th>
              <th style="color: var(--secondary-color)">Mode de paiement</th>
              <th style="color: var(--secondary-color)">Date paiement</th>
              <th style="color: var(--secondary-color)">Origine</th>
              <th style="color: var(--secondary-color)">Statut</th>
              <th class="ml-1 text-center" style="color: var(--secondary-color)">Montant</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-dataList>
            <tr>
              <td>
                <div class="d-flex align-items-center justify-content-center"
                     *ngIf="dataList.transaction.sens == 'ENTREE'"
                     style="background-color: #bdffd3; padding: 5px; border-radius: 6px;">
                  <i class="fad fa-chevron-double-down text-success"></i>
                </div>
                <div class="d-flex align-items-center justify-content-center"
                     *ngIf="dataList.transaction.sens == 'SORTIE'"
                     style="background-color: #ffbdbd; padding: 5px; border-radius: 6px;">
                  <i class="fad fa-chevron-double-up text-danger"></i>
                </div>
              </td>
              <td>
              <span class="ml-1 vertical-align-middle fw-bold" style="font-size: 11px">
   {{
                  dataList.client?.nomEtablissement
                    ? dataList.client?.nomEtablissement
                    : dataList.client?.nom
                      ? dataList.client?.nom + ' ' + dataList.client?.prenoms
                      : dataList.client?.raisonSocial
                }}
</span>

              </td>
              <td>
          <span class="ml-1 vertical-align-middle" style="font-size: 11px">
            {{ dataList.transaction.motif }}
          </span>
              </td>
              <td>
          <span class="ml-1 vertical-align-middle" style="font-size: 11px">
             {{ dataList.moyenPaiement }}
          </span>
              </td>

              <td>
          <span class="ml-1 vertical-align-middle" style="font-size: 11px">
           {{ dataList.datePaiement | date: 'dd/MM/yyyy à HH:mm' }}
          </span>
              </td>
              <td>
          <span class="ml-1 vertical-align-middle" style="font-size: 11px"
                [ngClass]="dataList.transaction.sens == 'ENTREE' ? 'text-success' : 'text-danger'">
             {{ dataList.transaction.sens }}
          </span>
              </td>
              <td>
          <span class="ml-1 vertical-align-middle" style="font-size: 11px"
                [ngClass]="dataList.transaction.sens == 'ENTREE' ? 'text-success' : 'text-danger'">
             {{ dataList.statut || 'N/A' }}
          </span>
              </td>
              <td>
                <div class="text-center" [ngClass]="dataList.transaction.sens == 'ENTREE' ? 'bg-entry' : 'bg-out'">
             <span class="ml-1 vertical-align-middle w-100 fw-bold " style="font-size: 12px">
             {{ dataList.transaction.sens == 'ENTREE' ? '+' : '' }}{{ dataList.montant | currency:'XOF' }}
          </span>
                </div>
              </td>
            </tr>

          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5">Aucun élément trouvé.</td>
            </tr>
          </ng-template>
        </p-table>
      </div>


      <div class="modal-footer gap-3 px-4">
        <button (click)="OnCloseModal()" type="button" class="btn btn-secondary px-2">Fermer</button>
      </div>
    </div>
  </div>
</div>

